---
layout: post
title:  "OpenCV Basics - Miscellaneous"
date:   2016-12-27 16:00:00
tags: [opencv, miscellaneous]
categories: CV
---

> 转自[OpenCV入门教程](http://blog.csdn.net/poem_qianmo/article/details/19925819)

#### 1. <opencv2/opencv.hpp>
该文件已经包含了各模块头文件：
{% highlight C++ %}
#ifndef __OPENCV_ALL_HPP__
#define __OPENCV_ALL_HPP__

#include "opencv2/core.hpp"
#include "opencv2/imgproc.hpp"
#include "opencv2/photo.hpp"
#include "opencv2/video.hpp"
#include "opencv2/features2d.hpp"
#include "opencv2/objdetect.hpp"
#include "opencv2/calib3d.hpp"
#include "opencv2/imgcodecs.hpp"
#include "opencv2/videoio.hpp"
#include "opencv2/highgui.hpp"
#include "opencv2/ml.hpp"

#endif
{% endhighlight %}
原则上，在写opencv程序时，可以只包含头文件opencv.hpp，这样可以精简优化代码

#### 2. CV_VERSION
cout该宏，可以检查程序所用的OpenCV库的版本号

#### 3. imwrite
{% highlight C++ %}
vector<int>compression_params;
compression_params.push_back(IMWRITE_PNG_COMPRESSION);
compression_params.push_back(9);
imwrite("存图名称.png", mat, compression_params);
{% endhighlight %}
* JPEG：params表示0到100的图片质量（CV_IMWRITE_JPEG_QUALITY），默认值为95
* PNG：params表示压缩级别（CV_IMWRITE_PNG_COMPRESSION），从0到9，其值越大，压缩尺寸越小，压缩时间越长；
* PPM / PGM / PBM：params表示二进制格式标志（CV_IMWRITE_PXM_BINARY），取值为0或1，默认是1。

#### 4. imshow - OpenGL show GpuMat
{% highlight C++ %}
cuda::GpuMat d_image;
d_image.upload(image);
namedWindow("Gpumat", WINDOW_OPENGL);  // 设定支持OpenGL!
cuda::cvtColor(d_image, d_image, cv::COLOR_BGR2GRAY);
imshow("Gpumat", d_image);

moveWindow("Gpumat", 0, 200 );  // window也可以移动!
{% endhighlight %}

#### 5. Mat
ROI Rect
{% highlight C++ %}
imageROI= image(Rect(800,350,logo.cols,logo.rows));  //使用矩形界定
// or 使用行和列界定
imageROI= image(Range(350,350+logo.rows),Range(800,800+logo.cols));
{% endhighlight %}
初始化
{% highlight C++ %}
Mat I = Mat::eye(4, 4, CV_64F);  // ones, zeros
I.at<double>(1,1) = CV_PI;  // 注意这么引用！

// 小矩阵可以这么写
Mat C = (Mat_<double>(3, 3) << 0, -1, 0, -1, 5, -1, 0, -1, 0);

Mat r = Mat(10, 3, CV_8UC3);
randu(r, Scalar::all(0), Scalar::all(255)); // 随机值填充，设定上下限
{% endhighlight %}
输出格式 format(r, Formatter::FMT_PYTHON)
{% highlight C++ %}
cout << "r (OpenCV默认风格) = " << r << ";" << endl << endl;
// Python风格 更清晰
cout << "r (Python风格) = " << format(r, Formatter::FMT_PYTHON) << ";" << endl << endl;
cout << "r (Numpy风格) = " <<  format(r, Formatter::FMT_NUMPY )<< ";" << endl << endl;
cout << "r (逗号分隔风格) = " << format(r, Formatter::FMT_CSV   )<< ";" << endl<< endl;
cout << "r (C语言风格) = " <<  format(r, Formatter::FMT_C     ) << ";" << endl << endl;
{% endhighlight %}

#### 6. [TrackBar Useage](https://github.com/wykvictor/OpenCV3-Intro-Example/blob/master/chapter3/17_CreateTrackbar/17_CreateTrackbar.cpp#L97)

#### 7. [Mouse Useage](https://github.com/wykvictor/OpenCV3-Intro-Example/blob/master/chapter3/18_UseMouse/18_UseMouse.cpp#L58)

#### 8. Rect
{% highlight C++ %}
Rect rect = rect1 | rect2;  // 矩形交集
rect = rect1 & rect2;  // 矩形并集
rect = rect + Point(20, -10);  // 矩形平移
rect = rect + Size(-30, -30);  // 矩形缩放
{% endhighlight %}
